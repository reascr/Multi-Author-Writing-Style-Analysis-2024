Their current actions must also be viewed within the context of current South Korean President Yoon Suk-yeol having publicly stated that he wishes for the US to redeploy tactical nuclear weapons to South Korea, in addition to expressing a desire for South Korea to develop its own indigenous nuclear arsenal.
While it is true that North Korea is prone to acting out pettily, it has not exactly helped that America has derailed many the genuine attempts of rapprochement between the North and South. South Korean President Kim Dae-jung was livid with the Bush administration after the "axis of evil" speech which ruined years of diplomatic progress and for cancelling a summit in North Korea which President Clinton had in the works.
To add to this: The mountainous terrain in North Korea is terribly ill-suited for farming and it is simply impossible for them to be self-sufficient in terms of food production with the size of their population. North Korea are already farming on most of their arable terrain, and their crop yields are not far off the international average, meaning that they have very limited potential for increasing their food production.
North Korea is trying to feed a modern-sized population (25,000,000) using medieval farming practices in a mostly hilly/mountainous country the size of Mississippi. Some years this actually works fine, on other years like the last three or so, famine will catch up to you just like in the medieval period. Because their fertilizer and industrial logistics are so fucked up, many remote villages rely on using human waste fertilizer, which is fine if safely and thoroughly composted, but they do not have time or space to do it. Instead, they directly apply it to the fields which increases the load of intestinal parasites in your body, greatly diminishing the calories you get in hard times.