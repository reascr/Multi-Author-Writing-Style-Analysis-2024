Turkey deliberately shot down a Russian warplane a few years back. There was an official protest, Turkey apologised, that's it. If it was clear and provable beyond doubt that Russian deliberately targeted a Turkish ship, they still probably wouldn't do more than lodge a protest.
And hitting civilian ships, even Turkish-owned ones, serves Russia: it informs that Ukranian ports are not safe. And because Ukraine won't (and can't) do the same with Russian ports, it creates a situation where Russian ports are safer.
Endrogan wants to play both sides and has set himself up as a diplomatic mastermind because he is in the position. Putin does not mind that Turkish ships are hit because he knows that Endrogan will not raise issue with that.
So as far as Putin is concerned, this is winning because wasting military hardwa like this, even though e can barely or not at all able to replace it, is his only hope of scavenging any sort of victory here. He has very little hope of gaining a military victory as long as Ukraine is supported.
This is what happens when the leadership becomes enarmored with their own bullshit. They become distanced from reality and believe that their goals are effective.