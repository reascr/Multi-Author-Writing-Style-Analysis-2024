That ad Biden actually didn't approve to be run but that was spread by his staff was obviously meant to be as condescending as possible (spiced up with some homophobic dogwhistles). In real life his policies changed the trajectory of the city from "dying" to being attractive and growing again, a downtown that resembled a ghost town in the evening to a lively place with tons of private development, and investments starting to come to poor neighborhoods. Like that sidewalk in a predominantly Latino neighborhood the ad misleadingly pretended to be in downtown.
Biden's transition team put him at Transportation because Buttigieg is an outstanding Secretary, a transportation nerd, has the political talent to help with Congress and can be used as spokesperson for the administration on nearly every topic. Not having him in the cabinet would have been a major blunder, the only question was finding the best position.
I think giving him a cabinet position was strategic. This is what people do if they are interested in the future of a political party - they look for younger party members who have promise, and they put them in positions to get them experience and name recognition. I think it was said at the time, but transportation is something that a mayor actually would have had experience dealing with; and as you said, has lower stakes than something like State or Defense.
An endorsement by a candidate who's dropping out of the race doesn't guarantee any substantial number of their voters will be swayed. That might have worked 50 years ago, but much less so today. Especially when it's a little known and inexperienced politician endorsing is a former VP. Pete Buttigieg was no Teddy Kennedy and Biden was already the most known and most experienced candidate in the field. This wasn't a situation where Buttigieg had any real leverage.
I don't think it was actually that obvious buttigieg would lose. If Biden didn't catch he'd probably have the centrist lane. It was a longshot bid but not doomed to fail.