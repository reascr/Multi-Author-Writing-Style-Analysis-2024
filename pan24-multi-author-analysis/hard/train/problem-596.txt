I'm not a cop, but I imagine it's not easy to sort out victims/heros/criminal when you first come upon a scene of bloody chaos. A rifle here, a handgun there, two bloodied men, overexcited witnesses with conflicting accounts...
Officers rushing into the chaotic scene had spotted a blood-spattered man with a handgun, not knowing if he was a threat.
For fucks sake, cops arrive to a shooting and detain a man covered in blood beating down a pos. In this situation the police first on scene are going to subdue anyone who appears that they conducted violence and then sort shit out. Stop with your juvenile acab bullshit.
Pretty much everything you just said would be applied to the DA's office. Police arrest, they do not prosecute. The pos was presumably handled by law enforcement. Anything after arrest is on the head of the elected district attorney.
The DA is the top law enforcement official in their jurisdiction, and they are appointed by the electorate. It is not unusual for DA's to be at odds with actual on the ground enforcers.