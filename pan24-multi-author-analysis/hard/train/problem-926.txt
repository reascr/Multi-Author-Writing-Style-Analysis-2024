The USA gave Russia way more money than Germany in the last two decades. Germany made Russia poorer though trade.
Ukraine was very corrupt at that time. Its political leaders were extremely divided. And the clear majority of the Ukrainian population was against NATO membership and many even saw NATO as a threat.
So the weapons and training provided by western countries are some of the reasons for Ukraine's successful fight, but the resolve of the Ukrainian people is another key reason.
Also, western would not be willing to support Ukraine with intelligence, arms and funds that much if Ukrainians would not be seen as nation that is ready to use it.
On the one side, Ukraine chose to ally itself with the West, and it's not like it was unknown that Russia wouldn't like this nor was this done unilaterally by Ukraine.
Maybe if the Ukrainian politicians were in agreement of Ukraine joining the NATO and its population actually liked the NATO instead of seeing it to a large degree as an enemy, there would have been more support for membership from other countries.
Unless you believe that the decision makers in Ukraine and NATO didn't at all expect the possibility of escalation by Russia, please shut up because you don't disagree with me.