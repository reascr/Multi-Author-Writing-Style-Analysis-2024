Oh, I understand the confusion. CSTO itself was established in 2002. Until that time there was a treaty called Collective Security Treaty, which was signed in 1992 but took effect for 5 years starting from 1994. When the treaty expired in 1999, Azerbaijan did not renew it, because CST was a symbolic representation of Russian influence upon its members. Azerbaijan together with Georgia, Ukraine and Moldova established GUAM alliance in 1997 in order to counter this influence.
If you understand the situation regarding the region and the border disputes, the only long term solution is for Armenia to give up on its enclave inside Azerbaijan. No country will ever accept a bordering country with whom they have fought several wars, to have an enclave inside their country.
They both belong to the "Collective Security Treaty Organization" (Russia's equivalent of NATO) but they met in Brussels, not in the capital of their would-be ally Putin.
But Russia has tried to be the arbiter of Armenia and Azerbaijan anyway. Russia's massive defeat at the hands of Ukraine has undermined Putin's role to the point .